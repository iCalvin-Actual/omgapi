{"variants":[{"paths":["\/documentation\/omgapi\/apicredential"],"traits":[{"interfaceLanguage":"swift"}]}],"seeAlsoSections":[{"title":"Related Documentation","anchor":"Related-Documentation","identifiers":["doc:\/\/omgapi\/documentation\/omgapi\/Account","doc:\/\/omgapi\/documentation\/omgapi\/Profile","doc:\/\/omgapi\/documentation\/omgapi\/Posting"]},{"title":"String Extensions","identifiers":["doc:\/\/omgapi\/documentation\/omgapi\/AddressName"],"anchor":"String-Extensions","generated":true}],"primaryContentSections":[{"declarations":[{"languages":["swift"],"platforms":["macOS"],"tokens":[{"text":"typealias","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"APICredential"},{"text":" = ","kind":"text"},{"preciseIdentifier":"s:SS","kind":"typeIdentifier","text":"String"}]}],"kind":"declarations"},{"kind":"content","content":[{"level":2,"text":"Discussion","type":"heading","anchor":"discussion"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Typically an API Key or OAuth bearer token"}]},{"inlineContent":[{"type":"text","text":"A simple typealias around "},{"type":"codeVoice","code":"String"},{"type":"text","text":" lets the API be more clear when requesting a credential string in a parameter."}],"type":"paragraph"},{"inlineContent":[{"text":"If a request doesn’t have permission to perform the desired action with the given ","type":"text"},{"code":"Credential","type":"codeVoice"},{"type":"text","text":" value the API will throw "},{"identifier":"doc:\/\/omgapi\/documentation\/omgapi\/api\/Error\/unauthenticated","type":"reference","isActive":true},{"text":" to the callsite.","type":"text"}],"type":"paragraph"},{"text":"Authenticating your account","type":"heading","level":2,"anchor":"Authenticating-your-account"},{"type":"paragraph","inlineContent":[{"text":"If the need is not for general user login, you can get an API Key for your omg.lol ","type":"text"},{"identifier":"doc:\/\/omgapi\/documentation\/omgapi\/Account","isActive":true,"type":"reference"},{"text":" on ","type":"text"},{"identifier":"https:\/\/home.omg.lol","type":"reference","isActive":true},{"type":"text","text":"."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"After logging in, go to the Account page and find the API Key section at the very bottom of the page. That key will work as an "},{"isActive":true,"identifier":"doc:\/\/omgapi\/documentation\/omgapi\/APICredential","type":"reference"},{"type":"text","text":" for any Address registered by your Account, so keep it safe."}]},{"type":"codeListing","code":["let profile = try? await api.profile(\"app\", with: SecretStore.apiKey)"],"syntax":"swift"},{"anchor":"Authenticating-another-omglol-Account","level":2,"type":"heading","text":"Authenticating another `omg.lol` Account"},{"type":"paragraph","inlineContent":[{"isActive":true,"type":"reference","identifier":"https:\/\/api.omg.lol\/#token-get-oauth-exchange-an-authorization-code-for-an-access-token"},{"type":"text","text":" uses a standard OAuth flow to access an account. Users do not need to provide the app or omgapi any credentials or APIKeys, they simply will log in via the website and after choosing to enable API access for the app client."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Everything is built around a simple "},{"type":"codeVoice","code":"String"},{"type":"text","text":" typealias "},{"isActive":true,"identifier":"doc:\/\/omgapi\/documentation\/omgapi\/APICredential","type":"reference"},{"type":"text","text":". After performing a simple OAuth handshake the API provides the client with an "},{"type":"codeVoice","code":"APICredential"},{"text":" and the client should pass that credential for any authenticated requests going forward.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"To support optional authentication complete the following steps."}]},{"anchor":"Step-0-Register-your-client","text":"Step 0: Register your client","level":3,"type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Before you’ll be able to authenticate on behalf of an omg.lol account, you’ll first need to register your client application with omg.lol."}]},{"inlineContent":[{"text":"This is entirely outside of the scope of this API, I (Calvin) and the API itself have no ability to help you out here. Start with emailing ","type":"text"},{"type":"reference","isActive":true,"identifier":"mailto:help@omg.lol"},{"text":" with an introduction to your project, make sure to include the following info.","type":"text"}],"type":"paragraph"},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"text":"The name of your application","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"A support contact, including name, email, and url"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"A redirect URL for the OAuth flow to call upon completion","type":"text"}]}]}]},{"inlineContent":[{"type":"reference","isActive":true,"identifier":"https:\/\/home.omg.lol\/info\/api"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"Once your application is regestered you’ll receive a clientID and clientSecret. Save these values somewhere secure.","type":"text"}]},{"text":"Step 1: Present OAuth Flow","level":3,"anchor":"Step-1-Present-OAuth-Flow","type":"heading"},{"inlineContent":[{"type":"text","text":"Once you have your "},{"type":"codeVoice","code":"clientID"},{"type":"text","text":" you’ll be able to call "},{"code":"api.authURL(with:redirect:)","type":"codeVoice"},{"text":" to construct the root login URL. You’ll want to give the user an oppertunity to login to their omg.lol account by presenting a webpage with that URL, making sure to provide a redirect URL that will be called upon successful authentication.","type":"text"}],"type":"paragraph"},{"type":"codeListing","code":["let clientID: String = Secrets.omgClientID","let loginURL: URL? = api.authURL(with: clientID, redirect: \"app:\/\/\")"],"syntax":"swift"},{"type":"paragraph","inlineContent":[{"type":"text","text":"If you’re building on Apple platforms you may have access to the "},{"code":"AuthenticationServices","type":"codeVoice"},{"text":" framework, which provides convenience functions to perform an OAuth flow in-app. Otherwise you’ll need to manually listen for the OAuth callback to receive the OAuth authorization code.","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["import AuthenticationServices","","let webSession = ASWebAuthenticationSession(","  url: loginURL,","  callbackURLScheme: \"app:\/\/\"",") { (callbackUrl, error) in","  guard let callbackUrl = callbackUrl else {","    return","  }","  let components = URLComponents(url: callbackUrl, resolvingAgainstBaseURL: true)","","  guard let authCode = components?.queryItems?.filter ({ $0.name == \"code\" }).first?.value else {","    return","  }","}","webSession?.presentationContextProvider = self","webSession?.start()"]},{"level":3,"text":"Exchange token for APICredential","type":"heading","anchor":"Exchange-token-for-APICredential"},{"type":"paragraph","inlineContent":[{"text":"Once you’ve received an authentication code from the callback URL you’ll need to exchange that code for a useful ","type":"text"},{"type":"reference","identifier":"doc:\/\/omgapi\/documentation\/omgapi\/APICredential","isActive":true},{"type":"text","text":"."}]},{"type":"codeListing","code":["let clientID = Secrets.omgClientID","let clientSecret = Secrets.omgClientSecret","let credential = api.oAuthExchange(with: clientID, and: clientSecret, redirect: \"app:\/\/\", code: authCode)"],"syntax":"swift"},{"type":"paragraph","inlineContent":[{"text":"Once you have that ","type":"text"},{"identifier":"doc:\/\/omgapi\/documentation\/omgapi\/APICredential","isActive":true,"type":"reference"},{"text":" you’re all set, you can store that value for the duration of the login session and use it to perform authenticated requests.","type":"text"}]},{"code":["let profile = try? await api.profile(\"app\", with: apiCredential)"],"syntax":"swift","type":"codeListing"}]}],"schemaVersion":{"patch":0,"major":0,"minor":3},"abstract":[{"text":"Typealias around ","type":"text"},{"type":"codeVoice","code":"String"},{"type":"text","text":" used for server authorization"}],"sections":[],"kind":"symbol","metadata":{"modules":[{"name":"omgapi"}],"title":"APICredential","externalID":"s:6omgapi13APICredentiala","role":"symbol","symbolKind":"typealias","fragments":[{"text":"typealias","kind":"keyword"},{"text":" ","kind":"text"},{"text":"APICredential","kind":"identifier"}],"navigatorTitle":[{"text":"APICredential","kind":"identifier"}],"roleHeading":"Type Alias"},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/omgapi\/documentation\/omgapi\/APICredential"},"hierarchy":{"paths":[["doc:\/\/omgapi\/documentation\/omgapi"]]},"topicSections":[{"identifiers":["doc:\/\/omgapi\/documentation\/omgapi\/api\/authURL(with:redirect:)","doc:\/\/omgapi\/documentation\/omgapi\/api\/oAuthExchange(with:and:redirect:code:)"],"anchor":"Relevant-APIs","title":"Relevant APIs"}],"references":{"doc://omgapi/documentation/omgapi/AddressName":{"identifier":"doc:\/\/omgapi\/documentation\/omgapi\/AddressName","abstract":[{"type":"text","text":"Typealias around "},{"type":"codeVoice","code":"String"},{"type":"text","text":" represents a regestered Address on the omg.lol service."}],"url":"\/documentation\/omgapi\/addressname","fragments":[{"kind":"keyword","text":"typealias"},{"text":" ","kind":"text"},{"kind":"identifier","text":"AddressName"}],"navigatorTitle":[{"kind":"identifier","text":"AddressName"}],"role":"symbol","type":"topic","title":"AddressName","kind":"symbol"},"doc://omgapi/documentation/omgapi/Profile":{"url":"\/documentation\/omgapi\/profile","title":"Profile","navigatorTitle":[{"kind":"identifier","text":"Profile"}],"identifier":"doc:\/\/omgapi\/documentation\/omgapi\/Profile","role":"symbol","abstract":[{"text":"Represents an Address’ complete profile","type":"text"}],"fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"text":"Profile","kind":"identifier"}],"type":"topic","kind":"symbol"},"https://api.omg.lol/#token-get-oauth-exchange-an-authorization-code-for-an-access-token":{"title":"api.omg.lol","identifier":"https:\/\/api.omg.lol\/#token-get-oauth-exchange-an-authorization-code-for-an-access-token","titleInlineContent":[{"code":"api.omg.lol","type":"codeVoice"}],"type":"link","url":"https:\/\/api.omg.lol\/#token-get-oauth-exchange-an-authorization-code-for-an-access-token"},"doc://omgapi/documentation/omgapi/api/authURL(with:redirect:)":{"fragments":[{"kind":"keyword","text":"func"},{"text":" ","kind":"text"},{"text":"authURL","kind":"identifier"},{"text":"(","kind":"text"},{"kind":"externalParam","text":"with"},{"kind":"text","text":": "},{"preciseIdentifier":"s:SS","text":"String","kind":"typeIdentifier"},{"text":", ","kind":"text"},{"text":"redirect","kind":"externalParam"},{"text":": ","kind":"text"},{"preciseIdentifier":"s:SS","text":"String","kind":"typeIdentifier"},{"kind":"text","text":") -> "},{"text":"URL","kind":"typeIdentifier","preciseIdentifier":"s:10Foundation3URLV"},{"text":"?","kind":"text"}],"kind":"symbol","type":"topic","role":"symbol","title":"authURL(with:redirect:)","url":"\/documentation\/omgapi\/api\/authurl(with:redirect:)","abstract":[{"text":"Constructs the authorization URL for beginning an OAuth flow.","type":"text"}],"identifier":"doc:\/\/omgapi\/documentation\/omgapi\/api\/authURL(with:redirect:)"},"doc://omgapi/documentation/omgapi/api/Error/unauthenticated":{"title":"api.Error.unauthenticated","identifier":"doc:\/\/omgapi\/documentation\/omgapi\/api\/Error\/unauthenticated","type":"topic","url":"\/documentation\/omgapi\/api\/error\/unauthenticated","abstract":[{"text":"The request had missing or invalid credentials","type":"text"}],"kind":"symbol","role":"symbol","fragments":[{"kind":"keyword","text":"case"},{"text":" ","kind":"text"},{"kind":"identifier","text":"unauthenticated"}]},"doc://omgapi/documentation/omgapi/APICredential":{"identifier":"doc:\/\/omgapi\/documentation\/omgapi\/APICredential","abstract":[{"text":"Typealias around ","type":"text"},{"type":"codeVoice","code":"String"},{"type":"text","text":" used for server authorization"}],"url":"\/documentation\/omgapi\/apicredential","fragments":[{"kind":"keyword","text":"typealias"},{"text":" ","kind":"text"},{"text":"APICredential","kind":"identifier"}],"navigatorTitle":[{"kind":"identifier","text":"APICredential"}],"role":"symbol","type":"topic","title":"APICredential","kind":"symbol"},"mailto:help@omg.lol":{"title":"help@omg.lol","identifier":"mailto:help@omg.lol","titleInlineContent":[{"type":"text","text":"help@omg.lol"}],"type":"link","url":"mailto:help@omg.lol"},"doc://omgapi/documentation/omgapi/Account":{"title":"Account","identifier":"doc:\/\/omgapi\/documentation\/omgapi\/Account","type":"topic","url":"\/documentation\/omgapi\/account","abstract":[{"text":"A user account wrapper that provides access to account details.","type":"text"}],"kind":"symbol","role":"symbol","fragments":[{"text":"struct","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"Account"}],"navigatorTitle":[{"kind":"identifier","text":"Account"}]},"doc://omgapi/documentation/omgapi":{"url":"\/documentation\/omgapi","kind":"symbol","role":"collection","title":"omgapi","type":"topic","identifier":"doc:\/\/omgapi\/documentation\/omgapi","abstract":[{"text":"Swift wrapper to api.omg.lol","type":"text"}]},"https://home.omg.lol":{"title":"the website","identifier":"https:\/\/home.omg.lol","titleInlineContent":[{"type":"text","text":"the website"}],"type":"link","url":"https:\/\/home.omg.lol"},"doc://omgapi/documentation/omgapi/Posting":{"role":"article","url":"\/documentation\/omgapi\/posting","identifier":"doc:\/\/omgapi\/documentation\/omgapi\/Posting","abstract":[{"type":"text","text":"Creating and editing content with omgapi"}],"title":"Posting","type":"topic","kind":"article"},"doc://omgapi/documentation/omgapi/api/oAuthExchange(with:and:redirect:code:)":{"fragments":[{"kind":"keyword","text":"func"},{"text":" ","kind":"text"},{"text":"oAuthExchange","kind":"identifier"},{"text":"(","kind":"text"},{"text":"with","kind":"externalParam"},{"kind":"text","text":": "},{"preciseIdentifier":"s:SS","kind":"typeIdentifier","text":"String"},{"text":", ","kind":"text"},{"text":"and","kind":"externalParam"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"text":", ","kind":"text"},{"text":"redirect","kind":"externalParam"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"s:SS","text":"String"},{"text":", ","kind":"text"},{"text":"code","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"String","kind":"typeIdentifier","preciseIdentifier":"s:SS"},{"text":") ","kind":"text"},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"text":"throws","kind":"keyword"},{"text":" -> ","kind":"text"},{"preciseIdentifier":"s:6omgapi13APICredentiala","text":"APICredential","kind":"typeIdentifier"},{"kind":"text","text":"?"}],"abstract":[{"text":"Exchanges an OAuth authorization code for an API credential.","type":"text"}],"identifier":"doc:\/\/omgapi\/documentation\/omgapi\/api\/oAuthExchange(with:and:redirect:code:)","url":"\/documentation\/omgapi\/api\/oauthexchange(with:and:redirect:code:)","kind":"symbol","role":"symbol","title":"oAuthExchange(with:and:redirect:code:)","type":"topic"},"https://home.omg.lol/info/api":{"title":"See omg.lol API Help for more","identifier":"https:\/\/home.omg.lol\/info\/api","titleInlineContent":[{"type":"text","text":"See omg.lol API Help for more"}],"type":"link","url":"https:\/\/home.omg.lol\/info\/api"}}}